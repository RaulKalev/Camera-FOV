<Window
    x:Class="Camera_FOV.UI.LinkedModelsSelectionWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:Camera_FOV.UI"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    Title="Linked Models"
    Width="400"
    SizeToContent="Height"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    AllowsTransparency="True"
    Background="Transparent"
    Topmost="True"
    mc:Ignorable="d">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Dark.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <Style x:Key="CustomButtonStyle" TargetType="Button">
                <Setter Property="Background" Value="#333333"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderBrush" Value="#555555"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Margin" Value="5"/>
                <Setter Property="Padding" Value="10,5"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                             <Border Background="{TemplateBinding Background}" 
                                     BorderBrush="{TemplateBinding BorderBrush}" 
                                     BorderThickness="{TemplateBinding BorderThickness}" 
                                     CornerRadius="4">
                                 <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                             </Border>
                             <ControlTemplate.Triggers>
                                 <Trigger Property="IsMouseOver" Value="True">
                                     <Setter Property="Background" Value="#444444"/>
                                 </Trigger>
                             </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Background="Transparent" ClipToBounds="True">
        <!-- Outer Border with Opacity (matching MainWindow) -->
        <Border
            BorderBrush="Gray"
            BorderThickness="2"
            ClipToBounds="True"
            CornerRadius="10"
            Opacity="0.7"
            SnapsToDevicePixels="True">
            <Border.Effect>
                <BlurEffect KernelType="Gaussian" Radius="2" />
            </Border.Effect>
        </Border>

        <!-- Content Container -->
        <Border
            Margin="2,2,2,2"
            Background="#1E1E1E"
            CornerRadius="10">
        <Grid Margin="15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Title -->
            <TextBlock Text="Linked Models Detected" FontSize="18" FontWeight="Bold" Foreground="White" Margin="0,0,0,10"/>

            <!-- Message -->
            <TextBlock Grid.Row="1" Text="The project contains linked models. Do you want to include elements from linked models in the trace?" 
                       TextWrapping="Wrap" Foreground="#CCCCCC" Margin="0,0,0,15"/>

            <!-- List of Links (Initially Collapsed) -->
            <DataGrid x:Name="LinksDataGrid" Grid.Row="2" AutoGenerateColumns="False" 
                      HeadersVisibility="Column" Background="#252525" Foreground="White"
                      BorderBrush="#444444" BorderThickness="1" Margin="0,0,0,15"
                      CanUserAddRows="False" Visibility="Collapsed"
                      RowBackground="#252525" AlternatingRowBackground="#2D2D2D"
                      GridLinesVisibility="None">
                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#333333"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="Padding" Value="8,4"/>
                        <Setter Property="BorderBrush" Value="#444444"/>
                        <Setter Property="BorderThickness" Value="0,0,1,1"/>
                    </Style>
                </DataGrid.ColumnHeaderStyle>
                <DataGrid.CellStyle>
                    <Style TargetType="DataGridCell">
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#007ACC"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.CellStyle>
                <DataGrid.RowStyle>
                    <Style TargetType="DataGridRow">
                        <Setter Property="Background" Value="#252525"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#3A3A3A"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#404040"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.RowStyle>
                <DataGrid.Columns>
                    <DataGridCheckBoxColumn Binding="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" Header="Select" Width="60"/>
                    <DataGridTextColumn Binding="{Binding Name}" Header="Link Name" Width="*" IsReadOnly="True"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Buttons -->
            <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="BtnNo" Content="No" Click="BtnNo_Click" Style="{StaticResource CustomButtonStyle}" Width="80"/>
                <Button x:Name="BtnSelect" Content="Select Manually" Click="BtnSelect_Click" Style="{StaticResource CustomButtonStyle}" Width="120"/>
                <Button x:Name="BtnYes" Content="Yes (All)" Click="BtnYes_Click" Style="{StaticResource CustomButtonStyle}" Width="100" Background="#007ACC" BorderBrush="#007ACC"/>
            </StackPanel>
        </Grid>
        </Border>
    </Grid>
</Window>
